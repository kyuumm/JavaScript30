<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>JS Drum Kit</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="https://fav.farm/ğŸ”¥" />
</head>

<body>


  <div class="keys">
    <div data-key="65" class="key">
      <kbd>A</kbd>
      <span class="sound">clap</span>
    </div>
    <div data-key="83" class="key">
      <kbd>S</kbd>
      <span class="sound">hihat</span>
    </div>
    <div data-key="68" class="key">
      <kbd>D</kbd>
      <span class="sound">kick</span>
    </div>
    <div data-key="70" class="key">
      <kbd>F</kbd>
      <span class="sound">openhat</span>
    </div>
    <div data-key="71" class="key">
      <kbd>G</kbd>
      <span class="sound">boom</span>
    </div>
    <div data-key="72" class="key">
      <kbd>H</kbd>
      <span class="sound">ride</span>
    </div>
    <div data-key="74" class="key">
      <kbd>J</kbd>
      <span class="sound">snare</span>
    </div>
    <div data-key="75" class="key">
      <kbd>K</kbd>
      <span class="sound">tom</span>
    </div>
    <div data-key="76" class="key">
      <kbd>L</kbd>
      <span class="sound">tink</span>
    </div>
  </div>

  <audio data-key="65" src="sounds/clap.wav"></audio>
  <audio data-key="83" src="sounds/hihat.wav"></audio>
  <audio data-key="68" src="sounds/kick.wav"></audio>
  <audio data-key="70" src="sounds/openhat.wav"></audio>
  <audio data-key="71" src="sounds/boom.wav"></audio>
  <audio data-key="72" src="sounds/ride.wav"></audio>
  <audio data-key="74" src="sounds/snare.wav"></audio>
  <audio data-key="75" src="sounds/tom.wav"></audio>
  <audio data-key="76" src="sounds/tink.wav"></audio>

  <script>
    function removeTransistion(e) {
      //å½“ä¸€ä¸ªå…ƒç´ çš„csså±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè§¦å‘transitionendäº‹ä»¶ï¼Œ
      //åœ¨äº‹ä»¶å¯¹è±¡ä¸­åŒ…å«propertyNameå±æ€§ï¼ŒæŒ‡ç¤ºå“ªä¸ªcsså±æ€§çš„è¿‡æ¸¡å·²ç»ç»“æŸ
      if (e.propertyName !== 'transform') return;

      //å¦‚æœproperNameä¸æ˜¯transformï¼Œä¸æ‰§è¡Œåç»­
      //  e.classList.remove('playing');
      //è¿™ä¸ªå†™æ³•é”™è¯¯ï¼Œå› ä¸ºremoveTransistionçš„eä¼ å…¥çš„æ˜¯keysï¼Œæ˜¯ä¸€ä¸ªNodeListé›†åˆï¼Œä¸æ˜¯å•ä¸ªdomå…ƒç´ 


      // e.target.classList.remove('playing');
      //æˆ–è€…
      this.classList.remove('playing');

      //thisæŒ‡çš„æ˜¯å½“å‰è§¦å‘äº‹ä»¶çš„å…ƒç´ æœ¬èº«ï¼ŒæŒ‡çš„å°±æ˜¯é™¤æ³•è¿™ä¸ªäº‹ä»¶çš„.keyå…ƒç´ 
      //targetæŒ‡çš„æ˜¯çœŸæ­£è§¦å‘çš„é‚£ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å“ªä¸ªdomå…ƒç´ è§¦å‘äº†transistioned
    }


    function playingSound(e) {
      const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
      //æ³¨æ„è¿™é‡Œç”¨çš„æ˜¯åå¼•å·ï¼Œä¸æ˜¯å•å¼•å·ï¼Œå› ä¸ºè¦åˆ›å»ºæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œæ–¹ä¾¿åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡
      const key = document.querySelector(`.key[data-key="${e.keyCode}"]`);

      console.log(audio);
      if (!audio) return;
      // åœæ­¢ä¹‹å‰çš„éŸ³ä¹
      audio.currentTime = 0; //å°†æ’­æ”¾æ—¶é—´é‡ç½®ä¸º0,å¦åˆ™éŸ³ä¹é‡å¤å¿«é€ŸæŒ‰é”®æ—¶å€™ä¼šç›´åˆ°æ’­æ”¾å®Œåæ‰ç»§ç»­æ’­æ”¾
      audio.play();
      key.classList.add('playing');
      //==key.addClassName('playing');==//ä½¿ç”¨åŸç”Ÿjsæ·»åŠ class

      const keys = document.querySelectorAll('.key');
      //éå†æ‰€æœ‰keyå…ƒç´ ï¼Œkeysæ˜¯ä¸€ä¸ªNodelistï¼ŒforEachæ–¹æ³•å¯ä»¥éå†
      keys.forEach(key => key.addEventListener('transitionend', removeTransistion));

      // // æ™®é€šå†™æ³•
      // keys.forEach(function(key) {
      //   key.addEventListener('transitionend', removeTransistion);
      // });
      // // ç®­å¤´å‡½æ•°å†™æ³•
      // keys.forEach(key => key.addEventListener('transitionend', removeTransistion));
      //å¯¹äºæ¯ä¸ªkeyï¼Œæ‰§è¡ŒaddEventListeneræ“ä½œ
    }

    window.addEventListener('keydown', playingSound);
  </script>

  <!-- //å¤ä¹ ï¼š -->
  <!--
æ•è·é˜¶æ®µï¼ˆcaptureï¼‰å’Œå†’æ³¡é˜¶æ®µï¼ˆbubbleï¼‰
æ•è·ï¼šä»æœ€å¤–å±‚çš„å…ƒç´ å¼€å§‹ï¼Œé€å±‚å‘å†…æ•è·äº‹ä»¶ï¼Œç›´åˆ°äº‹ä»¶åˆ°è¾¾ç›®æ ‡å…ƒç´ ã€‚Capture
å†’æ³¡ï¼šä»ç›®æ ‡å…ƒç´ å¼€å§‹ï¼Œé€å±‚å‘å¤–å†’æ³¡äº‹ä»¶ï¼Œç›´åˆ°äº‹ä»¶åˆ°è¾¾æœ€å¤–å±‚çš„å…ƒç´ ã€‚bubble
addEventListener()æ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šuseCaptureï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºå†’æ³¡é˜¶æ®µï¼›å¦‚æœè®¾ä¸ºtrueï¼Œè¡¨ç¤ºæ•è·é˜¶æ®µã€‚

-->

</body>

</html>