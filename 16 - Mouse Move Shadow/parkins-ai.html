<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Mouse Shadow with Blur Effects</title>
  <link rel="icon" href="https://fav.farm/ğŸ”¥" />
</head>

<body>

  <div class="hero">
    <h1 contenteditable>ææƒ§</h1>
  </div>

  <style>
    html {
      color: black;
      font-family: sans-serif;
    }

    body {
      margin: 0;
      background: #f0f0f0;
    }

    .hero {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: black;
    }

    h1 {
      text-shadow: 10px 10px 0 rgb(0, 0, 0);
      font-size: 100px;
      transition: transform 0.05s ease-out, filter 0.1s ease-out;
      position: relative;
    }
  </style>

  <script>
    const walk = 100;
    const elementShakeAmount = 3;
    const shakeInterval = 50; // é¢¤æŠ–é—´éš”
    const ghostInterval = 500; // é‡å½±é—´éš”ï¼ˆæ¯”é¢¤æŠ–é•¿ï¼‰
    const ghostLifetime = 2000; // é‡å½±å­˜åœ¨æ—¶é—´
    const maxGhosts = 5; // æœ€å¤§é‡å½±æ•°é‡
    const blurInterval = 100; // æ¨¡ç³Šæ•ˆæœå˜åŒ–é—´éš”
    const maxBlur = 2; // æœ€å¤§æ¨¡ç³Šå€¼ï¼ˆpxï¼‰

    let lastShakeTime = 0;
    let lastGhostTime = 0;
    let lastBlurTime = 0; // è®°å½•ä¸Šæ¬¡æ¨¡ç³Šå˜åŒ–æ—¶é—´
    let ghostShadows = []; // å­˜å‚¨é‡å½±é˜´å½±

    const hero = document.querySelector('.hero');
    const text = hero.querySelector('h1');
    hero.addEventListener('mousemove', updateEffects);

    // ç”Ÿæˆéšæœºæ•°
    function getRandom(min, max) {
      return Math.random() * (max - min) + min;
    }

    // æ›´æ–°æ‰€æœ‰æ•ˆæœ
    function updateEffects(e) {
      const { offsetWidth: width, offsetHeight: height } = hero;
      let { offsetX: x, offsetY: y } = e;

      if (this !== e.target) {
        x = x + e.target.offsetLeft;
        y = y + e.target.offsetTop;
      }

      // è®¡ç®—åŸºç¡€é˜´å½±åç§»
      const xWalk = Math.round(x / width * walk) - (walk / 2);
      const yWalk = Math.round(y / height * walk) - (walk / 2);
      const baseShadowX = 0 - xWalk;
      const baseShadowY = 0 - yWalk;

      // å¤„ç†é¢¤æŠ–æ•ˆæœ
      const currentTime = Date.now();
      const canShake = currentTime - lastShakeTime > shakeInterval;

      const shakeX = canShake ? getRandom(-elementShakeAmount, elementShakeAmount) : 0;
      const shakeY = canShake ? getRandom(-elementShakeAmount, elementShakeAmount) : 0;
      const shadowShakeX = canShake ? getRandom(-10, 10) : 0;
      const shadowShakeY = canShake ? getRandom(-10, 10) : 0;

      if (canShake) {
        lastShakeTime = currentTime;
      }

      // å¤„ç†é‡å½±æ•ˆæœï¼ˆé—´éš”æ›´é•¿ï¼‰
      const canAddGhost = currentTime - lastGhostTime > ghostInterval && ghostShadows.length < maxGhosts;

      if (canAddGhost) {
        // æ·»åŠ æ–°çš„é‡å½±ï¼ˆä½ç½®éšæœºåç§»ï¼Œä¸ä¸åŸºç¡€é˜´å½±é‡åˆï¼‰
        const ghostOffsetX = getRandom(-30, 30);
        const ghostOffsetY = getRandom(-30, 30);
        const ghostOpacity = getRandom(0.2, 0.5);

        // ç¡®ä¿é‡å½±ä¸ä¸åŸºç¡€é˜´å½±å®Œå…¨é‡åˆ
        if (Math.abs(ghostOffsetX) > 5 || Math.abs(ghostOffsetY) > 5) {
          ghostShadows.push({
            x: baseShadowX + ghostOffsetX,
            y: baseShadowY + ghostOffsetY,
            opacity: ghostOpacity,
            createdAt: currentTime
          });
          lastGhostTime = currentTime;
        }
      }

      // ç§»é™¤è¿‡æœŸçš„é‡å½±
      ghostShadows = ghostShadows.filter(ghost =>
        currentTime - ghost.createdAt < ghostLifetime
      );

      // å¤„ç†å­—ä½“æ¨¡ç³Šæ•ˆæœ
      const canBlur = currentTime - lastBlurTime > blurInterval;
      // éšæœºç”Ÿæˆ0åˆ°maxBlurä¹‹é—´çš„æ¨¡ç³Šå€¼ï¼Œé—´éš”ä¸€æ®µæ—¶é—´æ‰å˜åŒ–
      const blurValue = canBlur ? getRandom(0, maxBlur) : text.style.filter ?
        parseFloat(text.style.filter.replace('blur(', '').replace('px)', '')) : 0;

      if (canBlur) {
        lastBlurTime = currentTime;
      }

      // æ„å»ºæ‰€æœ‰é˜´å½±ï¼ˆåŸºç¡€é˜´å½± + é¢¤æŠ– + é‡å½±ï¼‰
      const mainShadow = `${baseShadowX + shadowShakeX}px ${baseShadowY + shadowShakeY}px 8px rgba(207,207,207,0.7)`;

      // é‡å½±é˜´å½±
      const ghostShadowStrings = ghostShadows.map(ghost =>
        `${ghost.x}px ${ghost.y}px 12px rgba(150,150,150,${ghost.opacity})`
      );

      // åˆå¹¶æ‰€æœ‰é˜´å½±
      const allShadows = [mainShadow, ...ghostShadowStrings].join(', ');

      // åº”ç”¨æ‰€æœ‰æ•ˆæœ
      text.style.textShadow = allShadows;
      text.style.transform = `translate(${shakeX}px, ${shakeY}px)`;
      // åº”ç”¨æ¨¡ç³Šæ•ˆæœ
      text.style.filter = `blur(${blurValue}px)`;
    }
  </script>
</body>

</html>